# miranda-testdata
NetCDF example files used for the testing suite of `miranda`

## Contributing
To add a new dataset to the `miranda` testing data, please ensure you perform the following:

1. Create a new branch: `git checkout -b my_new_testdata_branch`
2. Place your dataset within an appropriate subdirectory (or create a new one, e.g. `mkdir data/my_new_data_folder`).
3. Run the sha256 checksum generation script: `python report_check_sums.py`
4. Commit your changes: `git add . && git commit -m "added my_new_testdata"`
5. Open a Pull Request.

To modify an existing dataset, be sure to remove the existing checksum file before running the `report_check_sums.py` script.

If you wish to load data from this repository using `pooch`, this can be done with the following procedure:

* To gather a single file:
```python
import pooch
import xarray as xr

GITHUB_URL = "https://github.com/Ouranosinc/miranda-testdata"
BRANCH_OR_COMMIT_HASH = "main" # or a specific branch name or commit hash

test_data_path = pooch.retrieve(
    url=f"{GITHUB_URL}/raw/{BRANCH_OR_COMMIT_HASH}/data/my_new_data_folder/my_test_file.nc",
    known_hash="sha256:c45a572c6db4756ae89458e4861687e12a14465c92ff3d95b5634f773de93a34",
)
ds = xr.open_dataset(test_data_path)
```

> [!NOTE]
> The following options only work for branches based on `Ouranosinc/miranda-testdata`, not forks.

If you wish to run the entire `miranda` testing suite locally against your branch, this can be set via an environment variable:
```shell
$ export MIRANDA_TESTDATA_BRANCH="my_new_testdata_branch"

$ pytest miranda
# or, alternatively:
$ tox
```

If you wish to run the entire `miranda` testing suite on the `Ouranosinc/miranda` GitHub Workflows (CI) against your branch,
this can be set via an environment variable default in the `.github/workflows/main.yml` workflow configuration:
```yaml
env:
  MIRANDA_TESTDATA_BRANCH: my_new_testdata_branch
```

> [!WARNING]
> Be aware that modifying this variable to a value other than the latest tagged version of `miranda-testdata`
> will trigger a GitHub Workflow that will block merging of your Pull Request until changes are made.

## Versioning
When updating a dataset in `miranda-testdata` using a development branch and Pull Request,
once changes have been merged to the `main` branch, you should tag a new version of `miranda-testdata`. 

The version tag of `miranda-testdata` should follow a [calendar versioning](https://calver.org/) scheme
(i.e. version string follows from `vYYYY.MM.DD-r#`) reflecting the date of the tag creation, with modifiers if required.

## Data Information

### Canadian Surface Reanalysis CaSR

* About the CaSR project: https://hpfx.collab.science.gc.ca/~scar700/rcas-casr/
* Data access: https://hpfx.collab.science.gc.ca/~scar700/rcas-casr/download.html
* Data License: https://open.canada.ca/en/open-government-licence-canada

### CMIP6

* About the CMIP6 project: https://wcrp-cmip.org/cmip6/
* About the data: https://pcmdi.llnl.gov/CMIP6/
* Data access: https://aims2.llnl.gov/search

### COPERNICUS (ERA5)

* About the ERA5 project: https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels?tab=overview
* About ERA5-Land project: https://cds.climate.copernicus.eu/datasets/reanalysis-era5-land?tab=overview
* Data license: https://apps.ecmwf.int/datasets/licences/copernicus/

### ECCC (AHCCD: Adjusted and Homogenized Canadian Climate Data)

* About the AHCCD project: https://www.canada.ca/en/environment-climate-change/services/climate-change/canadian-centre-climate-services/display-download/technical-documentation-adjusted-climate-data.html
* Data license: https://open.canada.ca/en/open-government-licence-canada

### NOAA (GHCND: Global Historical Climatology Network Daily)

* About the GHCND project: https://www.ncei.noaa.gov/products/land-based-station/global-historical-climatology-network-daily
* About the data:
  * https://www.ncei.noaa.gov/metadata/geoportal/rest/metadata/item/gov.noaa.ncdc:C00861/html
  * https://www.ncei.noaa.gov/data/global-historical-climatology-network-daily/doc/GHCND_documentation.pdf
* Data license: Public Domain

### NASA (Daymet)

* About the Daymet project: https://daymet.ornl.gov/overview
* Attribution: https://daymet.ornl.gov/citations
* Data license: Public Domain

[//]: # (Code below this line is autogenerated by `report_check_sums.py`)
## Available datasets
### Files

| File | Size | Checksum |
| ---- | ---- | -------- |
| NASA/daymet_v4_tmin_annavg_hi_1987.nc | 1.0 MiB | sha256:1c81c025847e4ca6ec04414ab39f15cff3bfe946dbeff6678c36f906ae38c0d7 |
| NASA/daymet_v4_tmax_annavg_hi_1987.nc | 1.0 MiB | sha256:2cddc075dd3f660220a5e6dec1cd7ea625bf1e258fe978303d69945d553ce0cc |
| NASA/daymet_v4_prcp_annttl_hi_1987.nc | 1.0 MiB | sha256:255ea804907770f2784f06939072caed42733c5a1f79d3d29f3dd0963c9cef78 |
| ECMWF/era5_tp-ptype_2024.zip | 1.3 MiB | sha256:beb62aaeaba06f25ef6beea91d3ea637018192cdc42c535a3810456ca55bd312 |
| ECMWF/era5_t2m-d2m_2024.nc | 1.2 MiB | sha256:b93251a8bce720bd08d9a812c9a27678c49381c0635888cb8249f581255301d9 |
| ECMWF/era5-land_d2m-t2m-skt-u10-v10-sp-tp_201105.nc | 301.6 kiB | sha256:baf10465ac70cabd9463bce3b7941d5111a030ef69d9505dfd826aedea2cd1ac |
| CaSRv31/19910924.nc | 729.0 kiB | sha256:f4d501dcab4cfa79da2226d245e10c61ad87c4f6387fd9dd7d72fadb01221516 |
| CMIP6/snw_day_CanESM5_historical_r1i1p1f1_gn_19910101-20101231.nc | 491.1 kiB | sha256:05263d68f5c7325439a170990731fcb90d1103a6c5e4f0c0fd1d3a44b92e88e0 |
